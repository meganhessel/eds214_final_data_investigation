---
title: "EDS214 Final Report"
format: html
editor: visual
author: Megan Hessel
theme: cosmo
project:
  output-dir: ../docs
execute: 
  warning: false
---

## Background

In 2000, Dr. Schaefer and colleagues investigated chemical fluxes in the Luquillo Experimental Forest watersheds of Puerto Rico following Hurricane Hugo. Hurricane Hugo was a distructive category 4 storm that passed through Puerto Rico on September 18, 1998 (Schaefer, McDowell, Scatena, and Asbury 2000) .

This GitHub repository reproduces a similar time series plot from their work, focusing on the Bisley watershed.

SCHAEFER, DOUGLAS. A.; McDOWELL, WILLIAM H.; SCATENA, FREDRICK N.; ASBURY,CLYDE E. 2000. Effects of hurricane disturbance on stream water concentrations and fluxes in eight tropical forest watersheds of the Luquillo Experimental Forest, Puerto Rico. Journal of Tropical Ecology 16:189Â±207.

## Data

Since the 1980s, stream water samples have been collected weekly at the Luquillo Experimental Forest in Puerto Rico, measuring chemical concentrations, average stream flow, pH, and more.

All the data accumulated can be found on the [EDI Data Portal.](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-luq.20.4923064)

However, for replication of only Figure 3 within the paper, four csvs are required (Quebrada 1, 2, and 3-Bisley and Puente Roto Mameyes (MPR) Chemistry Data) which can be found in the [EDI Data Portal](https://portal.edirepository.org/nis/mapbrowse?packageid=knb-lter-luq.20.4923064) or the [data](https://github.com/meganhessel/eds214_final_data_investigation/tree/main/data) folder within the GitHub repository.

## Methods

\(1\) Download, clean, and filter the data.

-   To properly replicate the time series plot, only sample id, sample date (from 1988 to 1996), and the chemical concentrations (K, NO3-N, Mg, Ca, NH4-N) are necessary.

\(2\) The moving average (ma) function takes an average of the concentrations within a 9 weeks time window (4.5 weeks before and 4.5 weeks after) of each sample date. Therefore, use the moving average function, to calculate the 9 week ma for all chemical concentrations at each site. Then combined the individual tables into a single main data frame.

```{r}
#| code-fold: true
#| echo: true

# Loading the moving average function 
source(here::here("R", "moving_avg_func.R"))

# Loading the cleaned and filtered data frames with the moving average calculations 
BQ1_data_ma <- readRDS(file = here::here("outputs", "BQ1.rds")) # this is where the rds file is saved
BQ2_data_ma <- readRDS(file = here::here("outputs", "BQ2.rds"))
BQ3_data_ma <- readRDS(file = here::here("outputs", "BQ3.rds"))
PRM_data_ma <- readRDS(file = here::here("outputs", "PRM.rds"))

# Combining all the data frames together 
full_data <- rbind(BQ1_data_ma, BQ2_data_ma, BQ3_data_ma, PRM_data_ma)

```

\(4\) With all the data calculated and accumulated, create a multilevel time series plot using ggplots.

## Results

The replicated time series plot shows the various chemical concentrations changing overtime at different rivers in the Bisley watershed.

![](images/time_series_plot_BIG-01.png)

The chemicals included in the study are (a) potassium, (b) nitrate-N, (c) magnesium, (d) calcium, (e) ammonium-N. The various colors represent different rivers within in the watershed. Lastly, the vertical dashed-line represents Hurricane Hugo's disruption.

The plot indicates that levels of potassium, nitrate-N, and magnesium increased sharply after the storm. Whereas, calcium concentrations did rise but at a more gradual rate. Due to a lack of data, ammonium-N concentration cannot be properly investigated.
